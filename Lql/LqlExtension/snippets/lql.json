{
    "Select All": {
        "prefix": "select",
        "body": [
            "${1:TableName}",
            "|> select(*)"
        ],
        "description": "Basic select all columns"
    },
    "Select Columns": {
        "prefix": "selectc",
        "body": [
            "${1:TableName}",
            "|> select(${1:TableName}.${2:Column1}, ${1:TableName}.${3:Column2})"
        ],
        "description": "Select specific columns"
    },
    "Select with Filter": {
        "prefix": "selectf",
        "body": [
            "${1:TableName}",
            "|> filter(fn(row) => row.${1:TableName}.${2:Column} ${3|=,>,<,>=,<=,!=|} ${4:value})",
            "|> select(*)"
        ],
        "description": "Select with filter using lambda syntax"
    },
    "Filter with AND": {
        "prefix": "filterand",
        "body": [
            "${1:TableName}",
            "|> filter(fn(row) => row.${1:TableName}.${2:Column1} ${3|=,>,<|} ${4:value1} and row.${1:TableName}.${5:Column2} ${6|=,>,<|} ${7:value2})",
            "|> select(*)"
        ],
        "description": "Filter with AND condition"
    },
    "Filter with OR": {
        "prefix": "filteror",
        "body": [
            "${1:TableName}",
            "|> filter(fn(row) => row.${1:TableName}.${2:Column1} ${3|=,>,<|} ${4:value1} or row.${1:TableName}.${5:Column2} ${6|=,>,<|} ${7:value2})",
            "|> select(*)"
        ],
        "description": "Filter with OR condition"
    },
    "Join Tables": {
        "prefix": "join",
        "body": [
            "${1:Table1}",
            "|> join(${2:Table2}, on = ${1:Table1}.${3:Id} = ${2:Table2}.${4:ForeignKey})",
            "|> select(${1:Table1}.${5:Column1}, ${2:Table2}.${6:Column2})"
        ],
        "description": "Inner join two tables"
    },
    "Left Join": {
        "prefix": "leftjoin",
        "body": [
            "${1:Table1}",
            "|> left_join(${2:Table2}, on = ${1:Table1}.${3:Id} = ${2:Table2}.${4:ForeignKey})",
            "|> select(${1:Table1}.${5:Column1}, ${2:Table2}.${6:Column2})"
        ],
        "description": "Left join two tables"
    },
    "Cross Join": {
        "prefix": "crossjoin",
        "body": [
            "${1:Table1}",
            "|> cross_join(${2:Table2})",
            "|> select(${1:Table1}.${3:Column1}, ${2:Table2}.${4:Column2})"
        ],
        "description": "Cross join two tables"
    },
    "Group By with Count": {
        "prefix": "groupby",
        "body": [
            "${1:TableName}",
            "|> group_by(${1:TableName}.${2:Column})",
            "|> select(${1:TableName}.${2:Column}, count(*) as ${3:count})"
        ],
        "description": "Group by with count aggregation"
    },
    "Group By with Sum": {
        "prefix": "groupbysum",
        "body": [
            "${1:TableName}",
            "|> group_by(${1:TableName}.${2:GroupColumn})",
            "|> select(${1:TableName}.${2:GroupColumn}, sum(${1:TableName}.${3:SumColumn}) as ${4:total})"
        ],
        "description": "Group by with sum aggregation"
    },
    "Group By with Having": {
        "prefix": "groupbyhaving",
        "body": [
            "${1:TableName}",
            "|> group_by(${1:TableName}.${2:Column})",
            "|> having(fn(g) => count(*) > ${3:5})",
            "|> select(${1:TableName}.${2:Column}, count(*) as ${4:cnt})"
        ],
        "description": "Group by with having clause"
    },
    "Order By Ascending": {
        "prefix": "orderby",
        "body": [
            "${1:TableName}",
            "|> order_by(${1:TableName}.${2:Column} asc)",
            "|> select(*)"
        ],
        "description": "Order by ascending"
    },
    "Order By Descending": {
        "prefix": "orderbydesc",
        "body": [
            "${1:TableName}",
            "|> order_by(${1:TableName}.${2:Column} desc)",
            "|> select(*)"
        ],
        "description": "Order by descending"
    },
    "Limit": {
        "prefix": "limit",
        "body": [
            "${1:TableName}",
            "|> order_by(${1:TableName}.${2:Column})",
            "|> limit(${3:10})",
            "|> select(*)"
        ],
        "description": "Limit results"
    },
    "Limit with Offset": {
        "prefix": "limitoffset",
        "body": [
            "${1:TableName}",
            "|> order_by(${1:TableName}.${2:Column})",
            "|> limit(${3:10})",
            "|> offset(${4:20})",
            "|> select(*)"
        ],
        "description": "Limit with offset for pagination"
    },
    "Select Distinct": {
        "prefix": "distinct",
        "body": [
            "${1:TableName}",
            "|> select_distinct(${1:TableName}.${2:Column})"
        ],
        "description": "Select distinct values"
    },
    "Union": {
        "prefix": "union",
        "body": [
            "${1:Table1}",
            "|> select(${1:Table1}.${2:Column})",
            "|> union(${3:Table2} |> select(${3:Table2}.${4:Column}))"
        ],
        "description": "Union of two queries"
    },
    "Union All": {
        "prefix": "unionall",
        "body": [
            "${1:Table1}",
            "|> select(${1:Table1}.${2:Column})",
            "|> union_all(${3:Table2} |> select(${3:Table2}.${4:Column}))"
        ],
        "description": "Union all of two queries"
    },
    "Let Binding": {
        "prefix": "let",
        "body": [
            "let ${1:queryName} = ${2:TableName} |> select(*)"
        ],
        "description": "Let binding for query variables"
    },
    "Case Expression": {
        "prefix": "case",
        "body": [
            "case",
            "    when ${1:condition1} then ${2:value1}",
            "    when ${3:condition2} then ${4:value2}",
            "    else ${5:default_value}",
            "end"
        ],
        "description": "Case expression"
    },
    "Lambda Filter": {
        "prefix": "fn",
        "body": [
            "fn(${1:row}) => ${2:row.Table.Column} ${3|=,>,<,>=,<=,!=|} ${4:value}"
        ],
        "description": "Lambda function for filter/having"
    },
    "Arithmetic in Select": {
        "prefix": "arith",
        "body": [
            "${1:TableName}",
            "|> select(${1:TableName}.${2:Column1} ${3|+,-,*,/|} ${1:TableName}.${4:Column2} as ${5:result})"
        ],
        "description": "Arithmetic operations in select"
    },
    "Aggregate Functions": {
        "prefix": "agg",
        "body": [
            "${1:TableName}",
            "|> group_by(${1:TableName}.${2:GroupColumn})",
            "|> select(${1:TableName}.${2:GroupColumn}, ${3|count,sum,avg,min,max|}(${1:TableName}.${4:Column}) as ${5:result})"
        ],
        "description": "Aggregate function in select"
    },
    "Full Pipeline": {
        "prefix": "pipeline",
        "body": [
            "${1:TableName}",
            "|> filter(fn(row) => row.${1:TableName}.${2:Column} ${3|=,>,<|} ${4:value})",
            "|> join(${5:OtherTable}, on = ${1:TableName}.${6:Id} = ${5:OtherTable}.${7:ForeignKey})",
            "|> group_by(${1:TableName}.${8:GroupColumn})",
            "|> order_by(${1:TableName}.${8:GroupColumn} ${9|asc,desc|})",
            "|> limit(${10:10})",
            "|> select(${1:TableName}.${8:GroupColumn}, count(*) as count)"
        ],
        "description": "Full pipeline with filter, join, group, order, limit"
    }
}
