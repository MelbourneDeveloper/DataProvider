<Project Sdk="h5.Target/24.11.53863">

  <PropertyGroup>
    <OutputType>Library</OutputType>
    <TargetFramework>netstandard2.1</TargetFramework>
    <LangVersion>9.0</LangVersion>
    <Nullable>enable</Nullable>
    <RootNamespace>Dashboard</RootNamespace>
    <TreatWarningsAsErrors>false</TreatWarningsAsErrors>
    <NoWarn>CS0626;CS1591;CA1812;CA2100;CS8632</NoWarn>
    <!-- H5 specific settings -->
    <DefineConstants>H5</DefineConstants>
    <UseLocalH5>true</UseLocalH5>
    <UpdateH5>false</UpdateH5>
  </PropertyGroup>

  <PropertyGroup>
    <!-- Disable analyzers that don't work with H5 -->
    <EnableNETAnalyzers>false</EnableNETAnalyzers>
    <EnforceCodeStyleInBuild>false</EnforceCodeStyleInBuild>
    <GenerateDocumentationFile>false</GenerateDocumentationFile>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="h5" Version="24.11.53878" />
    <PackageReference Include="h5.Core" Version="24.11.53879" />
  </ItemGroup>

  <!-- Copy wwwroot files to output -->
  <ItemGroup>
    <None Include="wwwroot/**/*" CopyToOutputDirectory="PreserveNewest" />
  </ItemGroup>

  <!-- Download React vendor files before build -->
  <Target Name="DownloadReactVendorFiles" BeforeTargets="Build" Condition="!Exists('$(MSBuildProjectDirectory)/wwwroot/js/vendor/react.development.js')">
    <Message Importance="high" Text="[Dashboard] Downloading React vendor files..." />
    <MakeDir Directories="$(MSBuildProjectDirectory)/wwwroot/js/vendor" />
    <DownloadFile
      SourceUrl="https://unpkg.com/react@18/umd/react.development.js"
      DestinationFolder="$(MSBuildProjectDirectory)/wwwroot/js/vendor"
      DestinationFileName="react.development.js" />
    <DownloadFile
      SourceUrl="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
      DestinationFolder="$(MSBuildProjectDirectory)/wwwroot/js/vendor"
      DestinationFileName="react-dom.development.js" />
    <Message Importance="high" Text="[Dashboard] React vendor files downloaded successfully." />
  </Target>

</Project>
